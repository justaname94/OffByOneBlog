{% extends 'core/base.html' %}
{% load markup_tags %}

{% block title %} {{ question.title }} {% endblock title %}

{% block body %}

<div class="section">

  <div class="container">
    {% comment %} <div class="content"> {% endcomment %}
      <p class="title">{{ question.title }}</p>
      <hr>
      <div class="columns is-fullheight">
        <div class="column is-1">
          <p class="has-text-centered  is-size-4">{{ question.score }}</p>
          {% if vote_form %}
          <form method="post" action="{{ vote_form_url }}">
            {% csrf_token %}
            {{ vote_form.as_p }}
            <input type="submit" class="button is-link" value="Vote">
          </form>
          {% endif %}
        </div>
        <div class="column is-8 has-text-justified">
          {{ question.body|apply_markup:"markdown" | linebreaks}}
          <br>
          {% for tag in question.tags.all %}
          <span class="tag is-dark is-medium">{{tag}}</span>
          {% endfor %}
          <br><br>
          <p class="is-size-4" style="margin-bottom: 0.3em">{{answers | length}} Answer{{answers|pluralize}}</p>
          <hr>

          {% for answer in answers %}
          <div class="columns" id="{% if answer.info.accepted %}accepted{% endif %}">
            <div class="column is-1">
              <p class="has-text-centered">{{ answer.info.score }}</p>
              {% if user.is_authenticated %}
                <form method="post" action="{{ answer.vote_url }}">
                  {% csrf_token %}
                  {{ answer.vote_form.as_p }}
                  <input type="submit" class="button is-link" value="Vote">
                </form>
              {% endif %}
            </div>
            <div class="column is-11">
              {{ answer.info.body|apply_markup:"markdown" | linebreaks}}
              <div class="answer-data" style="margin-top: 0.5em">
                <p class="has-text-right"><strong>Answered: </strong> {{ answer.info.created | timesince }} ago by <strong>{{ answer.info.user }}</strong></p>
              </div>
            </div>
          </div>
          <hr>   
          {% endfor %}
                     
         {% if user.is_authenticated %}
            <form action="{{ answer_form_url }}" method="post">
            {% csrf_token %}
            <h2 class="title is-size-4" id="answer">Your Answer</h2>
            {% comment %} <textarea class="textarea" name="a" id="" rows="5"></textarea> {% endcomment %}
            {{ answer_form.body }}
            <p><strong>Tip: </strong>You can use markdown here</p>
            <div class="options"> 
              <button type="submit" name="action" value="SAVE" class="button is-link">Answer</button>
            </div>
          </form>
          {% else %}
            <p class="has-text-centered">You need to be logged in to post an answer. You can log in <a href="#" class="has-text-link">Here</a>.</p>
          {% endif %}
        
      </div>

      <div class="column is-3">
        <article class="message">
          <div class="message-header">
            <p>Placeholder temporal sidebar</p>
            <button class="delete" aria-label="delete"></button>
          </div>
          <div class="message-body">
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. <strong>Pellentesque risus mi</strong>, tempus
            quis placerat ut, porta nec nulla. Vestibulum rhoncus ac ex sit amet fringilla. Nullam gravida purus diam,
            et dictum <a>felis venenatis</a> efficitur. Aenean ac <em>eleifend lacus</em>, in mollis lectus. Donec
            sodales, arcu et sollicitudin porttitor, tortor urna tempor ligula, id porttitor mi magna a neque. Donec
            dui urna, vehicula et sem eget, facilisis sodales sem.
          </div>
        </article>
      </div>
    </div>
    {% comment %} </div> {% endcomment %}
</div>

</div>

{% endblock body %}